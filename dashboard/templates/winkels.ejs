<%- include("partials/header", { bot, user, path, title: `Settings | ${guild.name}` }) %>

<div class="container-sm center" style="margin-top: 30px;">
  <div class="d-grid gap-2 col-4 mx-auto">
    <% if (alert) { %>
      <div class="alert alert-success" role="alert">
        <%= alert %>
      </div>
    <% } %>
    <h1><%= guild.name %></h1>
    <hr>
    <form method="POST">
      <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Titel:</p>
      <p style="font-style: italic;" class="disabled">Verander de embed titel.</p>
      <input type="text" class="form-control" name="prefix" value="<%= settings.prefix %>" placeholder="Your prefix.">
      <br><button type="submit" class="btn btn-secondary text-white">Save Settings</button>
    </form>
  </div>
  <% if (settings.lenght >= 15) { %>
    <p>Het maximaal aantal winkels is bereikt (15 van de 15)</p>
  <% } else { %>
    <button type="button" class="btn btn-success text-white" data-toggle="modal" data-target="#newStore" data-whatever="@mdo">Add winkel</button>
  <% } %>
    <div class="modal fade" id="newStore" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Winkel toevoegen</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <form method="POST" name="newStore">
                    <input type="hidden" name="task" value="NEW">
                    <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Naam:</p>
                    <p style="font-style: italic;" class="disabled">Geef de winkel een naam.</p>
                    <input type="text" class="form-control" name="name" value="<%= settings.name %>" placeholder="Naam" required maxlength="20">
                    <br>
                    <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Beschrijving:</p>
                    <p style="font-style: italic;" class="disabled">Voeg een beschrijving toe.</p>
                    <input type="text" class="form-control" name="description" value="<%= settings.description %>" placeholder="Beschrijving" required maxlength="50">
                    <br>
                    <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Stad:</p>
                    <p style="font-style: italic;" class="disabled">In welke stad is de winkel gevestigd?</p>
                    <select name='stad' class="form-control" required>
                      <option value="" disabled selected hidden>Selecteer een stad</option>
                      <option>Hollandia</option>
                      <option>Bruxia</option>
                      <option>The Bai</option>
                      <option>Minetopia</option>
                      <option>Pretpark</option>
                    </select>
                    <br>
                    <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Locatie</p>
                    <p style="font-style: italic;" class="disabled">Wat zijn de coördinaten van de winkel?</p>
                    <input type="text" class="form-control" name="location" value="<%= settings.location %>" placeholder="Locatie" required maxlength="20">
                    <br>
                    <button type="submit" class="btn btn-success">Save settings</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </form>
            </div>
          </div>
        </div>
      </div>
    <table class="table" id="storeList">
        <thead>
          <tr>
            <th>Winkel</th>
            <th>Beschrijving</th>
            <th>Opties</th>
          </tr>
        </thead>
        <tbody>
    <% settings.forEach(store => { %>
  
        <tr>
            <td><%= store.name %></td>
            <td><%= store.description %></td>
            <td><button type="button" class="btn btn-warning text-white" data-toggle="modal" data-target="#editStore-<%- store.name %>" data-whatever="@mdo"><i class='fas fa-pencil-alt'></i></button><button type="button" class="btn btn-danger text-white" data-toggle="modal" data-target="#deleteStore-<%- store.name %>" data-whatever="@mdo"><i class='fas fa-trash-alt'></i></button></td>
        </tr>
          <div class="modal fade" id="editStore-<%- store.name %>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Bewerk <%= store.name %></h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <form method="POST" name="editStore">
                      <input type="hidden" class="form-control" name="storeId" value="<%= store._id %>">
                      <input type="hidden" name="task" value="EDIT">
                      <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Naam:</p>
                      <p style="font-style: italic;" class="disabled">Geef de winkel een naam.</p>
                      <input type="text" class="form-control" name="name" value="<%= store.name %>" placeholder="Naam" required maxlength="20">
                      <br>
                      <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Beschrijving:</p>
                      <p style="font-style: italic;" class="disabled">Voeg een beschrijving toe.</p>
                      <input type="text" class="form-control" name="description" value="<%= store.description %>" placeholder="Beschrijving" required maxlength="50">
                      <br>
                      <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Stad:</p>
                      <p style="font-style: italic;" class="disabled">In welke stad is de winkel gevestigd?</p>
                      <select name='stad' class="form-control" required>
                        <option selected><%= store.stad %></option>
                        <option>Hollandia</option>
                        <option>Bruxia</option>
                        <option>The Bai</option>
                        <option>Minetopia</option>
                        <option>Pretpark</option>
                      </select>
                      <br>
                      <p class="h5" style="margin-bottom: 0.5rem; margin-top: 10px;">Locatie</p>
                      <p style="font-style: italic;" class="disabled">Wat zijn de coördinaten van de winkel?</p>
                      <input type="text" class="form-control" name="location" value="<%= store.location %>" placeholder="Locatie" required maxlength="20">
                      <br>
                      <button type="submit" class="btn btn-success">Save settings</button>
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </form>
              </div>
            </div>
            </div>
          </div>
          <div class="modal fade" id="deleteStore-<%- store.name %>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Verwijder <%= store.name %></h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                    <form method="POST">
                        <input type="hidden" name="task" value="DELETE">
                        <input type="text" class="form-control" name="storeId" value="<%= store._id %>" hidden>
                        <p style="font-style: italic;" class="disabled">Weet u zeker dat u <%= store.name %> wilt verwijderen?</p>
                        <br>
                        <button type="submit" class="btn btn-danger">Verwijder</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Sluit</button>
                    </form>
                </div>
              </div>
            </div>
          </div>
    <%
        });
    %>
</tbody>
</table>
</div>

<%- include("partials/footer") %>